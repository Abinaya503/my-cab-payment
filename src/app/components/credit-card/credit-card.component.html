<div class="credit-card-container">
  <div class="header">
    <button (click)="goBack()" class="back-button">
      <i class="back-icon">←</i> Back to Payment
    </button>
    <h1>Credit Card Payment</h1>
    <p>Complete your payment securely</p>
  </div>

  <!-- Error Message -->
  <div *ngIf="errorMessage" class="error-message">
    <i class="error-icon">⚠️</i>
    {{ errorMessage }}
  </div>

  <!-- Payment Summary -->
  <div class="payment-summary">
    <h3>Payment Summary</h3>
    <div class="summary-details">
      <div class="summary-item">
        <span class="label">Amount:</span>
        <span class="amount">₹{{ amount | number:'1.2-2' }}</span>
      </div>
    </div>
  </div>

  <div class="card-form">
    <!-- Credit Card Display -->
    <div class="card-list">
      <div class="card-item" [class.-active]="isCardFlipped">
        <!-- Front of Card -->
        <div class="card-item__side -front">
          <div class="card-item__cover">
            <div class="card-item__bg"></div>
          </div>
          <div class="card-item__wrapper">
            <div class="card-item__top">
              <div class="card-item__chip">
                <div class="chip"></div>
              </div>
              <div class="card-item__type">
                <img *ngIf="getCardType()" 
                     [src]="'https://raw.githubusercontent.com/muhammederdem/credit-card-form/master/src/assets/images/' + getCardType() + '.png'"
                     [alt]="getCardType()" class="card-item__typeImg">
              </div>
            </div>
            <div class="card-item__number">
              <span *ngFor="let char of getMaskedCardNumber().split(''); let i = index" 
                    class="card-item__numberItem" 
                    [class.-active]="i === getDisplayCardNumber().length">
                {{ char }}
              </span>
            </div>
            <div class="card-item__content">
              <div class="card-item__info">
                <div class="card-item__holder">Card Holder</div>
                <div class="card-item__name">
                  {{ cardName || 'Full Name' }}
                </div>
              </div>
              <div class="card-item__date">
                <div class="card-item__dateTitle">Expires</div>
                <div class="card-item__dateItem">
                  {{ cardMonth || 'MM' }}
                </div>
                /
                <div class="card-item__dateItem">
                  {{ cardYear ? cardYear.slice(-2) : 'YY' }}
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Back of Card -->
        <div class="card-item__side -back">
          <div class="card-item__cover">
            <div class="card-item__bg"></div>
          </div>
          <div class="card-item__band"></div>
          <div class="card-item__cvv">
            <div class="card-item__cvvTitle">CVV</div>
            <div class="card-item__cvvBand">
              <span *ngFor="let char of cardCvv.split('')" class="cvv-char">*</span>
            </div>
            <div class="card-item__type">
              <img *ngIf="getCardType()" 
                   [src]="'https://raw.githubusercontent.com/muhammederdem/credit-card-form/master/src/assets/images/' + getCardType() + '.png'"
                   [alt]="getCardType()" class="card-item__typeImg">
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Credit Card Form -->
    <div class="card-form__inner">
      <div class="card-input">
        <label for="cardNumber" class="card-input__label">Card Number</label>
        <input type="text" 
               id="cardNumber" 
               class="card-input__input" 
               [(ngModel)]="cardNumber"
               (input)="onCardNumberChange($event)"
               placeholder="1234 5678 9012 3456"
               maxlength="19">
      </div>
      
      <div class="card-input">
        <label for="cardName" class="card-input__label">Card Holder Name</label>
        <input type="text" 
               id="cardName" 
               class="card-input__input" 
               [(ngModel)]="cardName"
               placeholder="John Doe">
      </div>
      
      <div class="card-form__row">
        <div class="card-form__col">
          <div class="card-form__group">
            <label class="card-input__label">Expiration Date</label>
            <select class="card-input__input -select" 
                    [(ngModel)]="cardMonth">
              <option value="" disabled>Month</option>
              <option *ngFor="let month of getMonths()" 
                      [value]="month.value"
                      [disabled]="month.disabled">
                {{ month.label }}
              </option>
            </select>
            <select class="card-input__input -select" 
                    [(ngModel)]="cardYear"
                    (change)="onYearChange()">
              <option value="" disabled>Year</option>
              <option *ngFor="let year of getYears()" [value]="year">
                {{ year }}
              </option>
            </select>
          </div>
        </div>
        <div class="card-form__col -cvv">
          <div class="card-input">
            <label for="cardCvv" class="card-input__label">CVV</label>
            <input type="text" 
                   class="card-input__input" 
                   id="cardCvv" 
                   [(ngModel)]="cardCvv"
                   (focus)="onCvvFocus()"
                   (blur)="onCvvBlur()"
                   placeholder="123"
                   maxlength="4">
          </div>
        </div>
      </div>

      <button class="card-form__button" 
              (click)="processPayment()" 
              [disabled]="isLoading">
        <span *ngIf="isLoading" class="loading-spinner"></span>
        <span *ngIf="!isLoading">Pay ₹{{ amount | number:'1.2-2' }}</span>
        <span *ngIf="isLoading">Processing Payment...</span>
      </button>
    </div>
  </div>
</div>
